---
title: "Global Health & Economic Vulnerability"
format:
  html:
    toc: false
---

# Global Health Analysis

This website presents an exploratory data analysis of global health indicators
and their relationship to economic conditions across countries.

We combine **COVID-19 health data** from the [Google COVID-19 Open Data project](
https://github.com/GoogleCloudPlatform/covid-19-open-data) with **GDP per capita**
from the [World Bank API](https://api.worldbank.org/), and build a cleaned dataset
that can be reused for future work. We'll walk you through the entire process if
you would like to reproduce the same project at your own time!

---

## 1. Data Sources & Retrieval

We use two main sources:

::: {.columns}
::: {.column width="50%"}
### Health Data

- Provider: **Google / Harvard Global Health Institute (COVID-19 Open Data)**
- Format: CSV (`health.csv`)
- Access: Public Google Cloud Storage bucket  
- URL:  
  `https://storage.googleapis.com/covid19-open-data/v3/health.csv`
:::

::: {.column width="50%"}
### Economic Data

- Provider: **World Bank**
- Indicators:
  - `NY.GDP.PCAP.CD` — GDP per capita (current US$)
- Format: JSON from World Bank REST API
- Access: Public API endpoint
:::
:::

See the **Data & Methods** page for the exact Python code used to:

- Download `health.csv` directly from the URL
- Query the World Bank API for GDP per capita
- Merge both into a single tidy DataFrame (`df_clean`)

---

## 2. Key Questions

We focus on questions such as:

- How do **health outcomes** vary across income levels?
- Is there a visible relationship between **GDP per capita** and
  **COVID-19 burden** (e.g., cases or deaths per 100k)?
- Which regions appear as **outliers** in terms of health vs. income?

These are explored in more depth on the **Analysis & Visuals** page.

---

## 3. Interactive Exploration

Below is an example interactive widget that lets you explore a subset of
our final dataset.

```{python}
import pandas as pd
import plotly.express as px

# 1. Load enriched data
df_enriched = pd.read_csv("data/df_enriched.csv")

# 2. Create health_status if it doesn't already exist
if "health_status" not in df_enriched.columns:
    df_enriched["health_status"] = pd.cut(
        df_enriched["life_expectancy"],
        bins=[0, 65, 75, 80, 100],
        labels=["Low (≤65)", "Medium (65–75)", "High (75–80)", "Very High (>80)"],
    )

# 3. Prepare a clean subset for plotting (no NaNs in key columns)
plot_cols = [
    "health_expenditure_usd",
    "life_expectancy",
    "infant_mortality_rate",
    "location_key",
    "health_status",
]
df_plot = df_enriched.dropna(subset=plot_cols).copy()

# Ensure size column is non-negative and numeric
df_plot = df_plot[df_plot["infant_mortality_rate"] >= 0]

# 4. Build interactive Plotly scatter
fig = px.scatter(
    df_plot,
    x="health_expenditure_usd",
    y="life_expectancy",
    hover_name="location_key",
    color="health_status",
    size="infant_mortality_rate",
    size_max=30,
    title="Health Expenditure vs Life Expectancy (bubble size = Infant Mortality)",
    labels={
        "health_expenditure_usd": "Health Expenditure (USD per capita)",
        "life_expectancy": "Life Expectancy (years)",
        "infant_mortality_rate": "Infant Mortality (per 1,000 births)",
        "health_status": "Health Status Group",
    },
)

# log scale on x-axis
fig.update_xaxes(type="log")

fig

```

```{python}
import pandas as pd
import plotly.express as px

df_enriched = pd.read_csv("data/df_enriched.csv")

corr_vars = [
"life_expectancy", "health_expenditure_usd", "infant_mortality_rate",
"physicians_per_1000", "smoking_prevalence", "diabetes_prevalence"
]

corr = df_enriched[corr_vars].corr().round(2)

fig = px.imshow(
corr,
text_auto=True,
color_continuous_scale="RdBu_r",
zmin=-1, zmax=1,
title="Interactive Correlation Matrix: Key Health Indicators"
)
fig

```



```{python}
import pandas as pd
from itables import init_notebook_mode, show

init_notebook_mode(all_interactive=True)

df_enriched = pd.read_csv("data/df_enriched.csv")

cols = [
"location_key",
"life_expectancy",
"health_expenditure_usd",
"infant_mortality_rate"
]

show(
df_enriched[cols].sort_values("life_expectancy", ascending=False),
)

```

## 4. Key Visualizations

Here are some of the main figures from our analysis.

### Model Performance

![](images/modelperformance.png){fig-alt="Model performance of life expectancy models" width="70%"}

### Global Distribution of Mortality

![](images/globaldistribution_of_mortality.png){fig-alt="Global distribution of mortality rates" width="70%"}

### Distribution and Country Count

![](images/distribution_and_countrycount.png){fig-alt="Distribution of life expectancy and country counts" width="70%"}

### Correlation Matrix of Indicators

![](images/corrmatrix_indicators.png){fig-alt="Correlation matrix of health indicators" width="70%"}

### Health Spending vs Life Expectancy

![](images/healthspending_on_lifeexpectancy.png){fig-alt="Health spending vs life expectancy plot" width="70%"}
